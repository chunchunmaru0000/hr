#надо "../../память/пласт.ср"

;;
Приставка П значит пласт - Пласт Ряд
;;
лик ПРяд (
	стр нч
	ц32 запас
	ц32 размер
)

#се рнч8  (# (окак  стр р->нч) #)
#се рнч32 (# (окак *ч32 р->нч) #)
#се рнч64 (# (окак *ч64 р->нч) #)

;#define p_last(l) (plist_get((l), (l)->size - 1))
;#define plat_plist(l, o) (plat((l), (o)->st, (o)->size))

фц новый_пряд(начальный_размер: ц32) лик ПРяд (
	р есть лик ПРяд = пластом(мера &лик Ряд),
	р->запас = начальный_размер,
	р->размер = 0,
	р->нч = пластом(начальный_размер),
	воздать р,
)

фц добавить8(р: лик ПРяд смысл: ц8) ц32 (
	р->размер >= р->запас ?? (
		р->нч = р->нч.пере_пласт(р->размер, (р->запас *= 2) * мера(ц8))
	)
	рнч8[р->размер++] = смысл,
)
фц добавить32(р: лик ПРяд смысл: ч32) ц32 (
	р->размер >= р->запас ?? (
		р->нч = р->нч.пере_пласт(р->размер, (р->запас *= 2) * мера(ч32))
	)
	рнч32[р->размер++] = смысл,
)
фц добавить64(р: лик ПРяд смысл: ч64) ц32 (
	р->размер >= р->запас ?? (
		р->нч = р->нч.пере_пласт(р->размер, (р->запас *= 2) * мера(ч64))
	)
	рнч64[р->размер++] = смысл,
)

фц звено8 (р: лик ПРяд место: ц32) ц8  ( воздать (окак  стр р->нч)[р->размер] )
фц звено32(р: лик ПРяд место: ц32) ц32 ( воздать (окак *ч32 р->нч)[р->размер] )
фц звено64(р: лик ПРяд место: ц32) ц64 ( воздать (окак *ч64 р->нч)[р->размер] )

фц менять8 (р: лик ПРяд место: ц32 смысл: ц8)  тлен ( рнч8 [р->размер] = смысл )
фц менять32(р: лик ПРяд место: ц32 смысл: ч32) тлен ( рнч32[р->размер] = смысл )
фц менять64(р: лик ПРяд место: ц32 смысл: ч64) тлен ( рнч64[р->размер] = смысл )

; Ряд Добавить Раз
фц рдр8 (р: лик ПРяд из: стр  раз: ц32) тлен (
	раз == 0 ?? ( воздать, )
	р->запас < р->размер + раз ?? (
		р->нч = р->нч.пере_пласт(р->запас, мера(ц8) *
		(р->запас = р->запас * 2 + раз))
	)
	из.вторить(рнч8 + р->размер, раз * мера(ц8))
	р->размер += раз,
)
фц рдр32(р: лик ПРяд из: *ч32 раз: ц32) тлен (
	раз == 0 ?? ( воздать, )
	р->запас < р->размер + раз ?? (
		р->нч = р->нч.пере_пласт(р->запас, мера(ч32) *
		(р->запас = р->запас * 2 + раз))
	)
	из.вторить(рнч32 + р->размер, раз * мера(ч32))
	р->размер += раз,
)
фц рдр64(р: лик ПРяд из: *ч64 раз: ц32) тлен (
	раз == 0 ?? ( воздать, )
	р->запас < р->размер + раз ?? (
		р->нч = р->нч.пере_пласт(р->запас, мера(ч64) *
		(р->запас = р->запас * 2 + раз))
	)
	из.вторить(рнч64 + р->размер, раз * мера(ч64))
	р->размер += раз,
)
